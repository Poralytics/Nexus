<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NEXUS Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, sans-serif; background: linear-gradient(135deg, #0f172a, #1e293b); color: #f8fafc; }
.app { display: grid; grid-template-columns: 280px 1fr; min-height: 100vh; }
.sidebar { background: linear-gradient(180deg, #1e293b, #0f172a); padding: 2rem 1.5rem; border-right: 1px solid rgba(59,130,246,0.2); position: sticky; top: 0; height: 100vh; overflow-y: auto; }
.logo { display: flex; align-items: center; gap: 0.75rem; margin-bottom: 2rem; padding: 1rem; background: linear-gradient(135deg, rgba(59,130,246,0.1), rgba(139,92,246,0.1)); border-radius: 12px; }
.logo-icon { width: 45px; height: 45px; background: linear-gradient(135deg, #3b82f6, #8b5cf6); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.75rem; }
.logo-text { font-size: 1.5rem; font-weight: 800; background: linear-gradient(135deg, #60a5fa, #a78bfa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.nav-section { margin-bottom: 2rem; }
.nav-label { font-size: 0.7rem; font-weight: 700; color: #64748b; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 0.75rem; padding-left: 1rem; }
.nav-item { display: flex; align-items: center; gap: 0.75rem; padding: 0.85rem 1rem; margin-bottom: 0.35rem; border-radius: 10px; cursor: pointer; transition: all 0.2s; color: #94a3b8; font-weight: 500; }
.nav-item:hover { background: linear-gradient(135deg, rgba(59,130,246,0.15), rgba(139,92,246,0.15)); color: #60a5fa; }
.nav-item.active { background: linear-gradient(135deg, rgba(59,130,246,0.2), rgba(139,92,246,0.2)); color: #60a5fa; border-left: 3px solid #3b82f6; font-weight: 600; }
.nav-badge { margin-left: auto; background: linear-gradient(135deg, #dc2626, #b91c1c); color: white; font-size: 0.7rem; padding: 0.2rem 0.6rem; border-radius: 10px; font-weight: 700; }
.main { padding: 2rem 3rem; overflow-y: auto; max-height: 100vh; }
.header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid rgba(59,130,246,0.2); }
.header-title { font-size: 2.25rem; font-weight: 800; background: linear-gradient(135deg, #f8fafc, #cbd5e1); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.header-subtitle { color: #94a3b8; margin-top: 0.5rem; }
.header-actions { display: flex; gap: 1rem; align-items: center; }
.user-avatar { width: 48px; height: 48px; background: linear-gradient(135deg, #3b82f6, #8b5cf6); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: 700; cursor: pointer; }
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
.stat-card { background: linear-gradient(135deg, rgba(30,41,59,0.8), rgba(15,23,42,0.8)); border: 2px solid rgba(59,130,246,0.2); border-radius: 20px; padding: 2rem; position: relative; overflow: hidden; transition: all 0.3s; cursor: pointer; }
.stat-card:hover { transform: translateY(-6px); border-color: rgba(59,130,246,0.5); box-shadow: 0 12px 40px rgba(59,130,246,0.2); }
.stat-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 5px; background: linear-gradient(90deg, #3b82f6, #8b5cf6); }
.stat-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
.stat-label { color: #94a3b8; font-size: 0.95rem; font-weight: 600; text-transform: uppercase; }
.stat-icon { width: 56px; height: 56px; background: linear-gradient(135deg, rgba(59,130,246,0.2), rgba(139,92,246,0.2)); border-radius: 14px; display: flex; align-items: center; justify-content: center; font-size: 1.75rem; }
.stat-value { font-size: 3rem; font-weight: 800; background: linear-gradient(135deg, #f8fafc, #cbd5e1); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 0.75rem; }
.stat-change { display: flex; align-items: center; gap: 0.5rem; font-size: 0.9rem; font-weight: 600; }
.stat-change.positive { color: #10b981; }
.stat-change.negative { color: #ef4444; }
.section-title { font-size: 1.5rem; font-weight: 700; margin-bottom: 1.5rem; color: #f8fafc; }
.quick-actions { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.25rem; margin-bottom: 2rem; }
.action-card { background: linear-gradient(135deg, rgba(59,130,246,0.08), rgba(139,92,246,0.08)); border: 2px solid rgba(59,130,246,0.2); border-radius: 16px; padding: 1.75rem; cursor: pointer; transition: all 0.3s; }
.action-card:hover { transform: translateY(-4px); border-color: rgba(59,130,246,0.5); box-shadow: 0 8px 32px rgba(59,130,246,0.3); }
.action-icon { font-size: 2.5rem; margin-bottom: 1rem; }
.action-title { font-weight: 700; font-size: 1.1rem; margin-bottom: 0.5rem; color: #f8fafc; }
.action-desc { font-size: 0.9rem; color: #94a3b8; }
.charts-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 1.5rem; margin-bottom: 2rem; }
.chart-card { background: linear-gradient(135deg, rgba(30,41,59,0.8), rgba(15,23,42,0.8)); border: 2px solid rgba(59,130,246,0.2); border-radius: 20px; padding: 2rem; }
.chart-title { font-size: 1.35rem; font-weight: 700; color: #f8fafc; margin-bottom: 2rem; }
.activity-item { display: flex; gap: 1.25rem; padding: 1.25rem; margin-bottom: 1rem; background: linear-gradient(135deg, rgba(59,130,246,0.05), rgba(139,92,246,0.05)); border-left: 4px solid rgba(59,130,246,0.5); border-radius: 12px; }
.activity-icon { width: 48px; height: 48px; background: linear-gradient(135deg, #3b82f6, #2563eb); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; flex-shrink: 0; }
.activity-title { font-weight: 700; color: #f8fafc; font-size: 0.95rem; margin-bottom: 0.35rem; }
.activity-desc { font-size: 0.85rem; color: #94a3b8; margin-bottom: 0.35rem; }
.activity-time { font-size: 0.75rem; color: #64748b; }
.btn { padding: 0.85rem 1.75rem; border-radius: 12px; border: none; font-weight: 700; cursor: pointer; transition: all 0.3s; display: inline-flex; align-items: center; gap: 0.75rem; }
.btn-primary { background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; }
.btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(59,130,246,0.5); }
@media (max-width: 1400px) { .charts-grid { grid-template-columns: 1fr; } }
@media (max-width: 1024px) { .app { grid-template-columns: 1fr; } .sidebar { position: relative; height: auto; } }
</style>
</head>
<body>
<div class="app">
<div class="sidebar">
<div class="logo">
<div class="logo-icon">üõ°Ô∏è</div>
<div class="logo-text">NEXUS</div>
</div>
<div class="nav-section">
<div class="nav-label">Dashboard</div>
<div class="nav-item active"><span>üìä</span> Overview</div>
</div>
<div class="nav-section">
<div class="nav-label">Security</div>
<div class="nav-item" onclick="window.location='/domains.html'"><span>üåê</span> Domains</div>
<div class="nav-item" onclick="window.location='/scans.html'"><span>üîç</span> Scans <span class="nav-badge">5</span></div>
<div class="nav-item" onclick="window.location='/vulnerabilities.html'"><span>‚ö†Ô∏è</span> Vulnerabilities <span class="nav-badge">12</span></div>
</div>
<div class="nav-section">
<div class="nav-label">Management</div>
<div class="nav-item" onclick="window.location='/executive'"><span>üëî</span> Executive</div>
</div>
<div class="nav-section">
<div class="nav-label">Account</div>
<div class="nav-item" onclick="window.location='/pricing'"><span>üí≥</span> Billing</div>
<div class="nav-item" onclick="logout()"><span>üö™</span> Logout</div>
</div>
</div>

<div class="main">
<div class="header">
<div>
<div class="header-title">Security Command Center</div>
<div class="header-subtitle">Real-time security monitoring and threat analysis</div>
</div>
<div class="header-actions">
<div class="user-avatar" id="avatar">A</div>
</div>
</div>

<div class="stats-grid">
<div class="stat-card">
<div class="stat-header">
<span class="stat-label">Security Score</span>
<span class="stat-icon">üõ°Ô∏è</span>
</div>
<div class="stat-value" id="score">850</div>
<div class="stat-change positive">‚Üë 12% vs last month</div>
</div>
<div class="stat-card" onclick="window.location='/domains.html'">
<div class="stat-header">
<span class="stat-label">Active Domains</span>
<span class="stat-icon">üåê</span>
</div>
<div class="stat-value" id="domains">8</div>
<div class="stat-change positive">+2 new this week</div>
</div>
<div class="stat-card" onclick="window.location='/vulnerabilities.html'">
<div class="stat-header">
<span class="stat-label">Vulnerabilities</span>
<span class="stat-icon">‚ö†Ô∏è</span>
</div>
<div class="stat-value" id="vulns">12</div>
<div class="stat-change negative">3 critical</div>
</div>
<div class="stat-card" onclick="window.location='/scans.html'">
<div class="stat-header">
<span class="stat-label">Scans/Month</span>
<span class="stat-icon">üîç</span>
</div>
<div class="stat-value">156</div>
<div class="stat-change positive">‚Üë 23%</div>
</div>
</div>

<div class="section-title">Quick Actions</div>
<div class="quick-actions">
<div class="action-card" onclick="window.location='/domains.html'">
<div class="action-icon">‚ö°</div>
<div class="action-title">Quick Scan</div>
<div class="action-desc">Run instant security scan</div>
</div>
<div class="action-card" onclick="window.location='/executive'">
<div class="action-icon">üìä</div>
<div class="action-title">Generate Report</div>
<div class="action-desc">Create executive report</div>
</div>
<div class="action-card" onclick="addDomain()">
<div class="action-icon">‚ûï</div>
<div class="action-title">Add Domain</div>
<div class="action-desc">Monitor new domain</div>
</div>
<div class="action-card" onclick="alert('Compliance coming soon!')">
<div class="action-icon">‚úÖ</div>
<div class="action-title">Check Compliance</div>
<div class="action-desc">ISO 27001, PCI-DSS status</div>
</div>
</div>

<div class="section-title">Security Trends</div>
<div class="charts-grid">
<div class="chart-card">
<div class="chart-title">Vulnerability Discovery Rate</div>
<canvas id="chart" height="100"></canvas>
</div>
<div class="chart-card">
<div class="chart-title">Recent Activity</div>
<div class="activity-item">
<div class="activity-icon">üîç</div>
<div>
<div class="activity-title">Scan Completed</div>
<div class="activity-desc">example.com - 3 issues found</div>
<div class="activity-time">2 mins ago</div>
</div>
</div>
<div class="activity-item">
<div class="activity-icon">‚ö†Ô∏è</div>
<div>
<div class="activity-title">Critical Vulnerability</div>
<div class="activity-desc">SQL Injection on test.com</div>
<div class="activity-time">15 mins ago</div>
</div>
</div>
<div class="activity-item">
<div class="activity-icon">‚úÖ</div>
<div>
<div class="activity-title">Vulnerability Fixed</div>
<div class="activity-desc">XSS resolved on demo.com</div>
<div class="activity-time">1 hour ago</div>
</div>
</div>
</div>
</div>
</div>
</div>

<script>
const token = localStorage.getItem('token');
if (!token) window.location.href = '/login';

async function loadData() {
  try {
    const res = await fetch('/api/auth/profile', { headers: { 'Authorization': 'Bearer ' + token }});
    if (res.ok) {
      const data = await res.json();
      document.getElementById('avatar').textContent = (data.user.name || data.user.email)[0].toUpperCase();
    }
    const scoreRes = await fetch('/api/score', { headers: { 'Authorization': 'Bearer ' + token }});
    if (scoreRes.ok) {
      const scoreData = await scoreRes.json();
      document.getElementById('score').textContent = scoreData.score || 850;
    }
    const domainsRes = await fetch('/api/domains', { headers: { 'Authorization': 'Bearer ' + token }});
    if (domainsRes.ok) {
      const domainsData = await domainsRes.json();
      document.getElementById('domains').textContent = domainsData.length || 0;
    }
  } catch(e) { console.log('Using demo data'); }
}

const ctx = document.getElementById('chart');
new Chart(ctx, {
  type: 'line',
  data: {
    labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
    datasets: [{
      label: 'Critical', data: [2,3,1,4,2,1,0], borderColor: '#dc2626', tension: 0.4, borderWidth: 3
    }, {
      label: 'High', data: [5,7,4,6,5,3,4], borderColor: '#f97316', tension: 0.4, borderWidth: 3
    }, {
      label: 'Medium', data: [8,10,12,9,11,8,7], borderColor: '#f59e0b', tension: 0.4, borderWidth: 3
    }]
  },
  options: {
    responsive: true,
    plugins: { legend: { labels: { color: '#94a3b8' }}},
    scales: {
      y: { beginAtZero: true, grid: { color: 'rgba(59,130,246,0.1)'}, ticks: { color: '#94a3b8' }},
      x: { grid: { color: 'rgba(59,130,246,0.1)'}, ticks: { color: '#94a3b8' }}
    }
  }
});

function addDomain() {
  const url = prompt('Enter domain URL (e.g., https://example.com):');
  if (url) {
    fetch('/api/domains', {
      method: 'POST',
      headers: { 'Authorization': 'Bearer ' + token, 'Content-Type': 'application/json' },
      body: JSON.stringify({ url, name: url.replace(/https?:\/\//, '').split('/')[0] })
    }).then(res => {
      if (res.ok) { alert('‚úÖ Domain added!'); loadData(); }
      else alert('Error adding domain');
    });
  }
}

function logout() {
  if (confirm('Logout?')) {
    localStorage.removeItem('token');
    window.location.href = '/login';
  }
}

loadData();
setInterval(loadData, 30000);
</script>
</body>
</html>
